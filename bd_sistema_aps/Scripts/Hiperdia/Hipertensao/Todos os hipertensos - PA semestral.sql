SELECT 
    tc.co_seq_cidadao AS codigo,
    tc.no_cidadao AS nome,
    tc.dt_nascimento AS dt_nascimento,
    COUNT(*) AS num_afericoes,
    CEIL(AVG(CAST(split_part(tam.nu_medicao_pressao_arterial, '/', 1) AS NUMERIC))) AS PA_sistolica_media,
    CEIL(AVG(CAST(split_part(tam.nu_medicao_pressao_arterial, '/', 2) AS NUMERIC))) AS PA_diastolica_media
FROM tb_cidadao tc
LEFT JOIN tb_prontuario tp 
    ON tc.co_seq_cidadao = tp.co_cidadao 
LEFT JOIN tb_atend ta 
    ON ta.co_prontuario = tp.co_seq_prontuario  
LEFT JOIN ta_medicao tam 
    ON tam.co_atend_prof = ta.co_atend_prof
WHERE 
    -- tam.nu_medicao_pressao_arterial IS NOT NULL AND 
    tam.dt_medicao >= CURRENT_DATE - INTERVAL '3 months'
    AND tc.no_cidadao IN (  -- Filtra apenas os pacientes listados
'ALDENIZIA SANGAMA DA SILVA',
'MARIA DO CARMO MARTINS LIMA',
'ANGELO ORLANDO DA SILVA',
'EDILENE GONÇALVES ROQUE',
'BENJAMIN LIMA TENAZOR',
'CARMEM DIAS DA ROCHA',
'LUIS ALBERTO NILSON CALISTRE',
'ADRIANA DA SILVA NOBRE',
'ARISTELVA NOGUEIRA MELO',
'ARMANDO BATISTA DE ALMEIDA',
'JOSYBETH DE ALMEIDA ORDONES',
'JOSE ARMARILDO OLIMPIO',
'ALVARO DA SILVA',
'JONAS ARAUJO DA SILVA',
'MARLI LOPES',
'ALGUSTO ALBAM FLORES',
'ALBERTINA PINHEIRO GOMES',
'PAULINO WADICK POSSIDONI',
'REGINA GOMES PINHEIRO',
'SANDRA CRISTINA WADICK',
'IVETE PEREIRA SANTOS',
'FRANCISCO SOUZA BEZERRA',
'DULCE DE CASTRO NOGUEIRA',
'ARTEMIO DA SILVA OLIMPIO',
'NILSON DE OLIVEIRA MONTEIRO',
'MATILDE GERMANO DA SILVA',
'ANETE CASTRO ALVES',
'MANOEL POCIDONIO DA SILVA',
'FRANCISCO LIMA FERREIRA',
'JOSE VIEIRA DO NASCIMENTO',
'AILTON CASTRO NOGUEIRA',
'ARLETE GOMES DE OLIVEIRA',
'GRACIETE SILVA DOS SANTOS',
'RAIMUNDO JAIR SOUZA RODRIGUES',
'RAQUEL DE MELO CANDIDO',
'ROSA GOMES DA CRUZ',
'MARILIA FERREIRA DA SILVA',
'CLAUDIO CASTRO NOGUEIRA',
'LUCIO FERREIRA DOS SANTOS',
'MARCOS MONTEIRO DA SILVA',
'LUIZ NASCIMENTO DA SILVA',
'PEDRO DE SOUZA CARTILHO',
'NAIR TAVARES KANAMARY',
'RAIMUNDA TONICO KANAMRY',
'SEBASTIÃO GALDINO PACIFICO',
'RAIMUNDA MELO DOS SANTOS',
'NELY HENRIQUE DOS SANTOS',
'SEBASTIÃO BARROSO SALVADOR',
'CREUZA TENORIO DA SILVA',
'VICTOR DE SOUZA BEZERRA',
'VALDIR DE ALMEIDA FELIX',
'MARIA DAS GRAÇAS BARBOSA DE SOUZA',
'MANOEL TENORIO DA SILVA',
'MARLUCIA CASTRO NOGUEIRA',
'TARCISIA FERREIRA NILO',
'IONAS DA SILVA GOMES',
'FRANCISCA OLIVEIRA MARTINS',
'RAIMUNDA N. OLIVEIRA DA COSTA',
'MARIA DJANIRA MORAES',
'CLOVIS OLIVEIRA DA COSTA',
'VITORINO DE SOUZA CASTILHO',
'RANDERVAL DA SILVA CHAGAS',
'TEREZA PEZO PANDURO',
'MARIA WILMA DA SILVA MAFRA',
'FRANCISCO FELIX PEREIRA',
'ALBERTINA MARINHO ELIAS',
'MARINA SOARES DE ANDRADE',
'RAIMUNDA SOUZA LOPES',
'LEONDRAS SOARES DE ANDRADE',
'PAULINA ANDRADE SOARES',
'CARLOS ALBERTO C. TENAZOR',
'WILSINHO DOS SANTOS MACIEL',
'MARIA FERREIRA DA SILVA',
'LEONCIO SOARES',
'JOSÉ AMAURI DA SILVA SOUZA',
'SIDENIR TENAZOR DA SILVA',
'RAIMISON LOPES TENAZOR',
'IVAN RODOLFO GUAQUETA ARIAS',
'FRANCISCA BATISTA DE ABREU',
'ALCRISNEI BRANDÃO DOS REMEDIOS',
'ESTELA ALMEIDA DE MORAIS',
'VALMIR DA SILVA AGUIAR',
'MARIA DA CONCEIÇÃO SILVA NUNES ALMEIDA',
'JOÃO FERREIRA SOBRINHO',
'DARLY RODRIGUES MELO',
'CARLOS ALBERTO VITOR LOPES',
'ANTONIO PINHEIRO BRAGA',
'MARIA JUCILANE GOMES DE ALMEIDA',
'RAFAEL PERES QUIRINO',
'ANDRE ASSIS MACIEL',
'LUZANIRA DE SOUZA BATISTA',
'REGIVALDO LUCAS DA SILVA',
'MARIA SUMAITA SAMIAS',
'JUAREZ CASTRO BARROSO',
'MARIA DULCIETE CASTRO BARROSO',
'MARIA SOCORRO DE SOUZA FERREIRA',
'FRANCISCA DA SILVA MATOS',
'LENUZIA BORGES DE OLIVEIRA',
'SEBASTIANA DA SILVA SOARES',
'MAURICELIO SOUZA DA SILVA',
'JOÃO DE SOUZA NEVES',
'ALCIRA OLIMPIO DA SILVA',
'MINELVINA FIGUEIRA ROCHA',
'MARIA DE SOUZA NUNES FILHO',
'IVANETE ELIAS JUVENAL',
'ANTONIA FERREIRA MALAFAIA',
'CLAUDENEISON MELO EUFRAZIO'
    )
GROUP BY 
    tc.co_seq_cidadao, 
    tc.no_cidadao,
    tc.dt_nascimento  -- Adicionado para garantir a consistência do GROUP BY
ORDER BY 
    PA_sistolica_media DESC, 
    PA_diastolica_media DESC;